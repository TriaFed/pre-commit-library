# Pre-commit Hooks Library for GenAI Code Validation

A comprehensive collection of pre-commit hooks designed to validate and secure code generated by AI tools like GitHub Copilot, ChatGPT, and other GenAI assistants.

## üéØ Purpose

This library provides pre-commit hooks specifically designed to:
- **Validate GenAI-generated code** for security vulnerabilities
- **Detect hardcoded credentials** and sensitive information
- **Scan for secrets** that might be accidentally included
- **Lint and format code** across multiple languages
- **Check for compliance** with security best practices
- **Prevent vulnerable patterns** common in AI-generated code

## üõ°Ô∏è Security Features

### GenAI-Specific Validations
- **Hardcoded URL detection** - Finds URLs that shouldn't be committed
- **Credential scanning** - Detects passwords, API keys, tokens
- **GenAI security patterns** - Identifies common AI code vulnerabilities
- **Secret scanning** with TruffleHog and detect-secrets
- **SAST scanning** with Semgrep for security vulnerabilities

### Language Support
- **Python** - Black, Flake8, isort, MyPy, Bandit, Safety
- **JavaScript/TypeScript** - ESLint, Prettier, TSC
- **Node.js** - npm/yarn audit for vulnerabilities
- **Angular** - Angular CLI linting
- **Java** - Checkstyle, SpotBugs
- **Terraform** - Format, validate, TFLint
- **CloudFormation** - Template validation
- **Docker** - Dockerfile linting with hadolint

## üöÄ Quick Start

### 1. Install pre-commit

```bash
# Using pip
pip install pre-commit

# Using Homebrew (macOS)
brew install pre-commit

# Using conda
conda install -c conda-forge pre-commit
```

### 2. Add to your project

Create a `.pre-commit-config.yaml` file in your project root:

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.0.1
    hooks:
      # Security hooks (recommended for all projects)
      - id: detect-secrets
      - id: hardcoded-urls
      - id: hardcoded-credentials
      - id: genai-security-check
      
      # Language-specific hooks
      - id: python-black
      - id: python-flake8
      - id: eslint
      - id: prettier
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # Standard file validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### 3. Install the hooks

```bash
pre-commit install
```

### 4. Run on all files (optional)

```bash
pre-commit run --all-files
```

## üìã Available Hooks

### üîí Security Hooks

| Hook ID | Description | Languages |
|---------|-------------|-----------|
| `detect-secrets` | Detect secrets using Yelp's detect-secrets | All |
| `truffhog` | Secret scanning with TruffleHog | All |
| `hardcoded-urls` | Detect hardcoded URLs | All |
| `hardcoded-credentials` | Detect hardcoded passwords/keys | All |
| `genai-security-check` | GenAI-specific security validation | All |
| `bandit` | Python security linter | Python |
| `safety-python` | Python dependency vulnerability scanner | Python |
| `npm-audit` | Node.js vulnerability scanner | Node.js |
| `yarn-audit` | Yarn vulnerability scanner | Node.js |
| `semgrep` | Multi-language SAST scanner | All |

### üé® Code Quality Hooks

| Hook ID | Description | Languages |
|---------|-------------|-----------|
| `python-black` | Python code formatter | Python |
| `python-flake8` | Python linter | Python |
| `python-isort` | Python import sorter | Python |
| `python-mypy` | Python type checker | Python |
| `eslint` | JavaScript/TypeScript linter | JS/TS |
| `prettier` | Code formatter | JS/TS/JSON/CSS/MD |
| `typescript-check` | TypeScript compiler check | TypeScript |
| `angular-lint` | Angular linting | Angular |
| `java-checkstyle` | Java style checker | Java |
| `java-spotbugs` | Java bug detector | Java |

### üèóÔ∏è Infrastructure Hooks

| Hook ID | Description | Languages |
|---------|-------------|-----------|
| `terraform-fmt` | Terraform formatter | Terraform |
| `terraform-validate` | Terraform validation | Terraform |
| `terraform-tflint` | Terraform linter | Terraform |
| `cloudformation-validate` | CloudFormation validation | CloudFormation |
| `dockerfile-lint` | Dockerfile linting | Docker |

### üìÅ File Validation Hooks

| Hook ID | Description | File Types |
|---------|-------------|------------|
| `check-yaml` | YAML syntax validation | .yaml, .yml |
| `check-json` | JSON syntax validation | .json |
| `check-xml` | XML syntax validation | .xml |
| `check-toml` | TOML syntax validation | .toml |
| `trailing-whitespace` | Remove trailing whitespace | All text |
| `end-of-file-fixer` | Ensure files end with newline | All text |
| `check-merge-conflict` | Check for merge conflicts | All text |
| `check-large-files` | Prevent large files | All |
| `check-license` | Check for license headers | Source files |

## üîß Configuration Examples

### Minimal Security Setup

For projects using GenAI tools, start with these essential security hooks:

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.0.1
    hooks:
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: check-large-files
```

### Python Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.0.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: bandit
      - id: safety-python
      
      # Code Quality
      - id: python-black
      - id: python-flake8
      - id: python-isort
      - id: python-mypy
      
      # File Validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### Node.js/React Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.0.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: npm-audit
      
      # Code Quality
      - id: eslint
      - id: prettier
      - id: typescript-check
      
      # File Validation
      - id: check-json
      - id: check-yaml
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### Java Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.0.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: semgrep
      
      # Code Quality
      - id: java-checkstyle
      - id: java-spotbugs
      
      # File Validation
      - id: check-xml
      - id: check-yaml
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### Infrastructure as Code

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.0.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      
      # Infrastructure
      - id: terraform-fmt
      - id: terraform-validate
      - id: terraform-tflint
      - id: cloudformation-validate
      - id: dockerfile-lint
      
      # File Validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
```

### Full Stack Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.0.1
    hooks:
      # Security (essential for GenAI projects)
      - id: detect-secrets
      - id: truffhog
      - id: hardcoded-urls
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: semgrep
      
      # Python
      - id: python-black
      - id: python-flake8
      - id: bandit
      - id: safety-python
      
      # JavaScript/TypeScript
      - id: eslint
      - id: prettier
      - id: npm-audit
      
      # Infrastructure
      - id: terraform-validate
      - id: dockerfile-lint
      
      # File Validation
      - id: check-yaml
      - id: check-json
      - id: check-xml
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-large-files
      - id: check-license
```

## üéõÔ∏è Hook Configuration

### Environment Variables

You can customize hook behavior using environment variables:

```bash
# npm audit severity level
export NPM_AUDIT_LEVEL=moderate  # low, moderate, high, critical

# Semgrep configuration
export SEMGREP_RULES=p/security-audit,p/secrets

# TruffleHog configuration
export TRUFFLEHOG_EXTRA_ARGS="--no-verification"
```

### Configuration Files

Many hooks support configuration files:

- **ESLint**: `.eslintrc.js`, `.eslintrc.json`
- **Prettier**: `.prettierrc`, `.prettierrc.json`
- **Checkstyle**: `checkstyle.xml`
- **detect-secrets**: `.secrets.baseline`
- **Semgrep**: `.semgrep.yml`

## üîç GenAI Security Features

### Hardcoded URL Detection

Detects potentially sensitive URLs that shouldn't be committed:

```python
# ‚ùå Will be flagged
api_url = "https://internal-api.company.com/v1"
database_url = "https://prod-db.company.com:5432"

# ‚úÖ Safe alternatives
api_url = os.getenv("API_URL")
database_url = config.get("DATABASE_URL")
```

### Credential Detection

Finds hardcoded passwords, API keys, and tokens:

```javascript
// ‚ùå Will be flagged
const apiKey = "sk-1234567890abcdef";
const password = "mySecretPassword123";

// ‚úÖ Safe alternatives
const apiKey = process.env.API_KEY;
const password = process.env.PASSWORD;
```

### GenAI Security Patterns

Detects common security anti-patterns in AI-generated code:

```python
# ‚ùå Insecure patterns flagged
import random
key = random.random()  # Weak randomness

query = "SELECT * FROM users WHERE id = " + user_id  # SQL injection

eval(user_input)  # Code injection

# ‚úÖ Secure alternatives
import secrets
key = secrets.token_hex(16)  # Cryptographically secure

cursor.execute("SELECT * FROM users WHERE id = %s", (user_id,))  # Parameterized query

# Don't use eval() with user input
```

## üõ†Ô∏è Installation Requirements

### Required Tools

The hooks will automatically check for required tools and provide installation instructions:

- **Python**: `pip install black flake8 isort mypy bandit safety detect-secrets`
- **Node.js**: `npm install -g eslint prettier @angular/cli`
- **Java**: Maven/Gradle with appropriate plugins
- **Security**: `pip install semgrep`, `brew install trufflehog`
- **Infrastructure**: `brew install terraform tflint hadolint`

### Optional Tools

Some tools provide enhanced functionality:
- **TruffleHog**: Advanced secret scanning
- **Semgrep**: Multi-language SAST
- **hadolint**: Dockerfile linting
- **cfn-lint**: CloudFormation linting

## üö® Troubleshooting

### Common Issues

1. **Hook not found**: Ensure the repository URL and revision are correct
2. **Tool not installed**: Install the required tool using provided instructions
3. **False positives**: Use ignore patterns or configuration files
4. **Performance**: Use `--no-verify` for emergency commits (not recommended)

### Ignoring False Positives

#### detect-secrets
```bash
# Generate baseline
detect-secrets scan --baseline .secrets.baseline

# Update baseline
detect-secrets scan --baseline .secrets.baseline --force-use-all-plugins
```

#### ESLint
```javascript
// eslint-disable-next-line rule-name
const problematicCode = "value";
```

#### Semgrep
```python
# nosemgrep: rule-id
potentially_flagged_code()
```

### Performance Optimization

For large repositories:

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.0.1
    hooks:
      - id: detect-secrets
        exclude: ^(docs/|tests/fixtures/)
      - id: eslint
        files: \.(js|jsx|ts|tsx)$
        exclude: node_modules/
```

## ü§ù Contributing

1. Fork the repository
2. Create a feature branch
3. Add new hooks or improve existing ones
4. Test your changes
5. Submit a pull request

### Adding New Hooks

1. Create the hook script in `hooks/`
2. Add entry to `.pre-commit-hooks.yaml`
3. Update documentation
4. Add example configuration

## üìù License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üîó Related Tools

- [pre-commit](https://pre-commit.com/) - The pre-commit framework
- [detect-secrets](https://github.com/Yelp/detect-secrets) - Secret detection
- [TruffleHog](https://github.com/trufflesecurity/trufflehog) - Secret scanning
- [Semgrep](https://semgrep.dev/) - Static analysis
- [Bandit](https://bandit.readthedocs.io/) - Python security linting

## üìä Compliance

This library helps ensure compliance with:
- **OWASP Top 10** security standards
- **CWE** (Common Weakness Enumeration) guidelines  
- **SANS** secure coding practices
- Enterprise security policies
- GenAI governance requirements

## üéØ Best Practices

### For GenAI Development

1. **Always run security hooks** on AI-generated code
2. **Review flagged issues** carefully - AI tools can include sensitive data
3. **Use environment variables** for configuration
4. **Validate all external inputs** in AI-generated code
5. **Regular dependency updates** to address vulnerabilities
6. **Code review** AI-generated code before merging

### Hook Configuration

1. **Start minimal** and add hooks gradually
2. **Configure tool-specific settings** using their config files
3. **Use excludes** for generated files and vendor directories
4. **Test hooks locally** before pushing
5. **Document team conventions** in your project README

---

**Made with ‚ù§Ô∏è for safer GenAI development**
