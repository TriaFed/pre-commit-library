# Pre-commit Hooks Library for GenAI Code Validation

A comprehensive collection of pre-commit hooks designed to validate and secure code generated by AI tools like GitHub Copilot, ChatGPT, and other GenAI assistants.

## üéØ Purpose

This library provides pre-commit hooks specifically designed to:
- **Validate GenAI-generated code** for security vulnerabilities
- **Detect hardcoded credentials** and sensitive information
- **Scan for secrets** that might be accidentally included
- **Lint and format code** across multiple languages
- **Check for compliance** with security best practices
- **Prevent vulnerable patterns** common in AI-generated code

## üõ°Ô∏è Security Features

### GenAI-Specific Validations
- **Hardcoded URL detection** - Finds URLs that shouldn't be committed
- **Credential scanning** - Detects passwords, API keys, tokens
- **GenAI security patterns** - Identifies common AI code vulnerabilities
- **Secret scanning** with TruffleHog and detect-secrets
- **SAST scanning** with Semgrep for security vulnerabilities

### Language Support
- **Python** - Black, Flake8, isort, MyPy, Bandit, Safety
- **JavaScript/TypeScript** - ESLint, Prettier, TSC
- **Node.js** - npm/yarn audit for vulnerabilities
- **Angular** - Angular CLI linting
- **Java** - Checkstyle, SpotBugs
- **.NET** - dotnet format, dotnet test, security scanning (C#, VB.NET, F#)
- **Go** - gofmt, golangci-lint, gosec security scanning
- **Ansible** - ansible-lint, syntax checking, security validation
- **Terraform** - Format, validate, TFLint
- **CloudFormation** - Template validation
- **Docker** - Dockerfile linting with hadolint

## üöÄ Quick Start

### 1. Install dependencies

**Quick setup for macOS:**
```bash
curl -fsSL https://raw.githubusercontent.com/TriaFed/pre-commit-library/main/install-macos.sh | bash
```

**Quick setup for Windows:**
```powershell
irm https://raw.githubusercontent.com/TriaFed/pre-commit-library/main/install-windows.ps1 | iex
```

**Manual installation:**
```bash
# Install pre-commit
pip install pre-commit

# See DEPENDENCIES.md for complete installation guide
```

### 2. Add to your project

Create a `.pre-commit-config.yaml` file in your project root:

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security hooks (recommended for all projects)
      - id: detect-secrets
      - id: hardcoded-urls
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: detect-verbose-flags
      
      # Language-specific hooks
      - id: python-black
      - id: python-flake8
      - id: eslint
      - id: prettier
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # Standard file validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### 3. Install the hooks

```bash
pre-commit install
```

### 4. Run on all files (optional)

```bash
pre-commit run --all-files
```

## üìã Available Hooks

### üîí Security Hooks

| Hook ID | Description | Languages |
|---------|-------------|-----------|
| `detect-secrets` | Detect secrets using Yelp's detect-secrets | All |
| `truffhog` | Secret scanning with TruffleHog | All |
| `hardcoded-urls` | Detect hardcoded URLs | All |
| `hardcoded-credentials` | Detect hardcoded passwords/keys | All |
| `genai-security-check` | GenAI-specific security validation | All |
| `bandit` | Python security linter | Python |
| `safety-python` | Python dependency vulnerability scanner | Python |
| `npm-audit` | Node.js vulnerability scanner | Node.js |
| `yarn-audit` | Yarn vulnerability scanner | Node.js |
| `semgrep` | Multi-language SAST scanner | All |
| `dotnet-security-scan` | .NET security scanner | C#/VB.NET/F# |
| `go-security-scan` | Go security scanner | Go |
| `ansible-security-scan` | Ansible security scanner | Ansible |
| `detect-verbose-flags` | Detect verbose flags and debug logging | All |

### üé® Code Quality Hooks

| Hook ID | Description | Languages |
|---------|-------------|-----------|
| `python-black` | Python code formatter | Python |
| `python-flake8` | Python linter | Python |
| `python-isort` | Python import sorter | Python |
| `python-mypy` | Python type checker | Python |
| `eslint` | JavaScript/TypeScript linter | JS/TS |
| `prettier` | Code formatter | JS/TS/JSON/CSS/MD |
| `typescript-check` | TypeScript compiler check | TypeScript |
| `angular-lint` | Angular linting | Angular |
| `java-checkstyle` | Java style checker | Java |
| `java-spotbugs` | Java bug detector | Java |
| `dotnet-format` | .NET code formatter | C#/VB.NET/F# |
| `dotnet-test` | .NET test runner | C#/VB.NET/F# |
| `go-fmt` | Go code formatter | Go |
| `go-lint` | Go linter with security checks | Go |
| `ansible-lint` | Ansible linting | Ansible |
| `ansible-syntax-check` | Ansible syntax validation | Ansible |

### üèóÔ∏è Infrastructure Hooks

| Hook ID | Description | Languages |
|---------|-------------|-----------|
| `terraform-fmt` | Terraform formatter | Terraform |
| `terraform-validate` | Terraform validation | Terraform |
| `terraform-tflint` | Terraform linter | Terraform |
| `cloudformation-validate` | CloudFormation validation | CloudFormation |
| `dockerfile-lint` | Dockerfile linting | Docker |

### üìÅ File Validation Hooks

| Hook ID | Description | File Types |
|---------|-------------|------------|
| `check-xml` | XML syntax validation | .xml |
| `check-license` | Check for license headers | Source files |

**Note:** For standard file validation hooks like `check-yaml`, `check-json`, `trailing-whitespace`, `end-of-file-fixer`, `check-merge-conflict`, `check-added-large-files`, and `check-toml`, use the official [pre-commit-hooks](https://github.com/pre-commit/pre-commit-hooks) repository alongside our security-focused hooks.

## üîß Configuration Examples

### Minimal Security Setup

For projects using GenAI tools, start with these essential security hooks:

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: check-added-large-files
```

### Python Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: bandit
      - id: safety-python
      
      # Code Quality
      - id: python-black
      - id: python-flake8
      - id: python-isort
      - id: python-mypy
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # File Validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### Node.js/React Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: npm-audit
      
      # Code Quality
      - id: eslint
      - id: prettier
      - id: typescript-check
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # File Validation
      - id: check-json
      - id: check-yaml
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### Java Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: semgrep
      
      # Code Quality
      - id: java-checkstyle
      - id: java-spotbugs
      
      # Custom File Validation
      - id: check-xml
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # Standard File Validation
      - id: check-yaml
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### .NET Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: dotnet-security-scan
      
      # Code Quality
      - id: dotnet-format
      - id: dotnet-test
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # File Validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### Go Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: go-security-scan
      
      # Code Quality
      - id: go-fmt
      - id: go-lint
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # File Validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### Ansible Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: ansible-security-scan
      
      # Ansible Validation
      - id: ansible-lint
      - id: ansible-syntax-check
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # File Validation
      - id: check-yaml
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

### Infrastructure as Code

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security
      - id: detect-secrets
      - id: hardcoded-credentials
      - id: genai-security-check
      
      # Infrastructure
      - id: terraform-fmt
      - id: terraform-validate
      - id: terraform-tflint
      - id: cloudformation-validate
      - id: dockerfile-lint
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # File Validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
```

### Full Stack Project

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      # Security (essential for GenAI projects)
      - id: detect-secrets
      - id: truffhog
      - id: hardcoded-urls
      - id: hardcoded-credentials
      - id: genai-security-check
      - id: detect-verbose-flags
      - id: semgrep
      
      # Python
      - id: python-black
      - id: python-flake8
      - id: bandit
      - id: safety-python
      
      # JavaScript/TypeScript
      - id: eslint
      - id: prettier
      - id: npm-audit
      
      # .NET
      - id: dotnet-format
      - id: dotnet-test
      - id: dotnet-security-scan
      
      # Go
      - id: go-fmt
      - id: go-lint
      - id: go-security-scan
      
      # Java
      - id: java-checkstyle
      - id: java-spotbugs
      
      # Ansible
      - id: ansible-lint
      - id: ansible-syntax-check
      - id: ansible-security-scan
      
      # Infrastructure
      - id: terraform-validate
      - id: dockerfile-lint
      
      # Custom File Validation
      - id: check-xml
      - id: check-license
  
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      # Standard File Validation
      - id: check-yaml
      - id: check-json
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-added-large-files
```

## üéõÔ∏è Hook Configuration

### Environment Variables

You can customize hook behavior using environment variables:

```bash
# npm audit severity level
export NPM_AUDIT_LEVEL=moderate  # low, moderate, high, critical

# Semgrep configuration
export SEMGREP_RULES=p/security-audit,p/secrets

# TruffleHog configuration
export TRUFFLEHOG_EXTRA_ARGS="--no-verification"
```

### Configuration Files

Many hooks support configuration files:

- **ESLint**: `.eslintrc.js`, `.eslintrc.json`
- **Prettier**: `.prettierrc`, `.prettierrc.json`
- **Checkstyle**: `checkstyle.xml`
- **detect-secrets**: `.secrets.baseline`
- **Semgrep**: `.semgrep.yml`

## üîç GenAI Security Features

### Hardcoded URL Detection

Detects potentially sensitive URLs that shouldn't be committed:

```python
# ‚ùå Will be flagged
api_url = "https://internal-api.company.com/v1"
database_url = "https://prod-db.company.com:5432"

# ‚úÖ Safe alternatives
api_url = os.getenv("API_URL")
database_url = config.get("DATABASE_URL")
```

### Credential Detection

Finds hardcoded passwords, API keys, and tokens:

```javascript
// ‚ùå Will be flagged
const apiKey = "sk-1234567890abcdef";
const password = "mySecretPassword123";

// ‚úÖ Safe alternatives
const apiKey = process.env.API_KEY;
const password = process.env.PASSWORD;
```

### GenAI Security Patterns

Detects common security anti-patterns in AI-generated code:

```python
# ‚ùå Insecure patterns flagged
import random
key = random.random()  # Weak randomness

query = "SELECT * FROM users WHERE id = " + user_id  # SQL injection

eval(user_input)  # Code injection

# ‚úÖ Secure alternatives
import secrets
key = secrets.token_hex(16)  # Cryptographically secure

cursor.execute("SELECT * FROM users WHERE id = %s", (user_id,))  # Parameterized query

# Don't use eval() with user input
```

## üõ†Ô∏è Installation Requirements

### Quick Setup (Recommended)

**macOS:**
```bash
curl -fsSL https://raw.githubusercontent.com/TriaFed/pre-commit-library/main/install-macos.sh | bash
```

**Windows:**
```powershell
irm https://raw.githubusercontent.com/TriaFed/pre-commit-library/main/install-windows.ps1 | iex
```

### Manual Installation by Language

**Python:**
```bash
pip install black flake8 isort mypy bandit safety detect-secrets
```

**JavaScript/TypeScript/Node.js:**
```bash
npm install -g eslint prettier typescript @angular/cli
```

**.NET:**
```bash
# Download from: https://dotnet.microsoft.com/download
# macOS: brew install --cask dotnet
# Windows: winget install Microsoft.DotNet.SDK.8
```

**Go:**
```bash
# Install Go: https://golang.org/dl/
# macOS: brew install go
# Windows: winget install GoLang.Go

# Install Go tools:
go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest
go install github.com/securecodewarrior/gosec/v2/cmd/gosec@latest
```

**Java:**
```bash
# Install JDK 17+
# macOS: brew install openjdk@17
# Windows: winget install Microsoft.OpenJDK.17

# Build tools:
# Maven: brew install maven / winget install Apache.Maven
# Gradle: brew install gradle / winget install Gradle.Gradle
```

**Ansible:**
```bash
pip install ansible ansible-lint
```

**Infrastructure Tools:**
```bash
# Terraform: brew install terraform / winget install Hashicorp.Terraform
# TFLint: brew install tflint / choco install tflint
# Hadolint: brew install hadolint / winget install Hadolint.Hadolint
```

**Security Tools:**
```bash
pip install semgrep
# TruffleHog: brew install trufflehog / winget install trufflesecurity.trufflehog
```

üìã **Complete installation guide:** [DEPENDENCIES.md](DEPENDENCIES.md)

### Optional Tools

Some tools provide enhanced functionality:
- **TruffleHog**: Advanced secret scanning
- **Semgrep**: Multi-language SAST
- **hadolint**: Dockerfile linting
- **cfn-lint**: CloudFormation linting

## üö® Troubleshooting

### Common Issues

1. **Hook not found**: Ensure the repository URL and revision are correct
2. **Tool not installed**: Install the required tool using provided instructions
3. **False positives**: Use ignore patterns or configuration files
4. **Performance**: Use `--no-verify` for emergency commits (not recommended)

### Ignoring False Positives

#### detect-secrets
```bash
# Generate baseline
detect-secrets scan --baseline .secrets.baseline

# Update baseline
detect-secrets scan --baseline .secrets.baseline --force-use-all-plugins
```

#### ESLint
```javascript
// eslint-disable-next-line rule-name
const problematicCode = "value";
```

#### Semgrep
```python
# nosemgrep: rule-id
potentially_flagged_code()
```

#### Verbose Flags Detection
```python
# ‚ùå Will be flagged
logging.basicConfig(level=logging.DEBUG)
debug = True
console.log("DEBUG: " + data)

# ‚úÖ Better alternatives
logging.basicConfig(level=os.getenv("LOG_LEVEL", "INFO"))
debug = os.getenv("DEBUG", "false").lower() == "true"
logger.debug("Processing data: %s", data)
```

### Performance Optimization

For large repositories:

```yaml
repos:
  - repo: https://github.com/TriaFed/pre-commit-library
    rev: v1.1.1
    hooks:
      - id: detect-secrets
        exclude: ^(docs/|tests/fixtures/)
      - id: eslint
        files: \.(js|jsx|ts|tsx)$
        exclude: node_modules/
```

## ü§ù Contributing

1. Fork the repository
2. Create a feature branch
3. Add new hooks or improve existing ones
4. Test your changes
5. Submit a pull request

### Adding New Hooks

1. Create the hook script in `hooks/`
2. Add entry to `.pre-commit-hooks.yaml`
3. Update documentation
4. Add example configuration

## üìù License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üîó Related Tools

- [pre-commit](https://pre-commit.com/) - The pre-commit framework
- [detect-secrets](https://github.com/Yelp/detect-secrets) - Secret detection
- [TruffleHog](https://github.com/trufflesecurity/trufflehog) - Secret scanning
- [Semgrep](https://semgrep.dev/) - Static analysis
- [Bandit](https://bandit.readthedocs.io/) - Python security linting

## üìä Compliance

This library helps ensure compliance with:
- **OWASP Top 10** security standards
- **CWE** (Common Weakness Enumeration) guidelines  
- **SANS** secure coding practices
- Enterprise security policies
- GenAI governance requirements

## üéØ Best Practices

### For GenAI Development

1. **Always run security hooks** on AI-generated code
2. **Review flagged issues** carefully - AI tools can include sensitive data
3. **Use environment variables** for configuration
4. **Validate all external inputs** in AI-generated code
5. **Regular dependency updates** to address vulnerabilities
6. **Code review** AI-generated code before merging

### Hook Configuration

1. **Start minimal** and add hooks gradually
2. **Configure tool-specific settings** using their config files
3. **Use excludes** for generated files and vendor directories
4. **Test hooks locally** before pushing
5. **Document team conventions** in your project README

---

**Made with ‚ù§Ô∏è for safer GenAI development**
